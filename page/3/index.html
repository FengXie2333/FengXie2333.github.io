<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="keep exceeding" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="keep exceeding">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="keep exceeding">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="keep exceeding">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/">





  <title>keep exceeding</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">keep exceeding</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/创建数据集/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/创建数据集/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:53+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h1><p>由数据组成的矩形数组，行表示观测，列表示变量。</p>
<h1 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h1><p>对象：可以赋值给变量的任何事物</p>
<p>对象都具有某种模式以及某个类</p>
<h2 id="向量"><a href="#向量" class="headerlink" title="向量"></a>向量</h2><p>向量 ：存储数值，字符，逻辑数据的数组</p>
<p>标量是只有一个元素的向量</p>
<p>一个向量中只能有一个数据类型</p>
<p>用函数<strong><em>c（）</em></strong>创建向量</p>
<p>用[]里加数字，来表示字符的位置</p>
<h2 id="矩阵"><a href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h2><p>矩阵是二维数组，数组中的每个元素具有相同的模式</p>
<p><strong><em>byrow</em></strong>表明矩阵应该按行填充（byrow = TRUE）还是按列填充。默认是按列填充。</p>
<p>用函数matrix（）来创建矩阵。</p>
<p>矩阵下标：</p>
<p>X[2,] 表示第二行</p>
<p>X[,2] 表示第二列</p>
<p>矩阵中也只能有一种数据类型</p>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>与矩阵类似，但是维度可以大于2</p>
<p>数组通过<strong><em>array（）</em></strong>创建</p>
<p>数组也只能有一种数据类型</p>
<h2 id="数据框"><a href="#数据框" class="headerlink" title="数据框"></a>数据框</h2><p>R 中最常使用的数据结构</p>
<p>数据框用函数<strong><em>data.frame()</em></strong>构建</p>
<p>可以有多种数据类型。但是每一列只能有一种。</p>
<h4 id="attach-detach-和with"><a href="#attach-detach-和with" class="headerlink" title="attach detach 和with"></a>attach detach 和with</h4><p>attach() :将数据框添加到R的搜索路径中   </p>
<p>detach() ：将数据框从搜索路径中移除</p>
<p>attach 和 detach 的局限：如果有变量重名。先出现的变量将会取得优先权。 ====&gt;报错：某个对象已被屏蔽（masked）</p>
<p>with() ：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">with（mtcars,&#123;</span><br><span class="line">    print (summary(mpg))</span><br><span class="line">    plot (mpg,disp)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>with：花括号内的赋值，只在内部起效</p>
<p>想要花括号内赋值在外面也能用，将赋值符号 &lt;- 改成 &lt;&lt;-</p>
<h4 id="实例标识符"><a href="#实例标识符" class="headerlink" title="实例标识符"></a>实例标识符</h4><p>可以用row.names来指定实例标识符</p>
<p>比如病人的id</p>
<h2 id="因子"><a href="#因子" class="headerlink" title="因子"></a>因子</h2><p>变量：名义型   有序型  连续型</p>
<p>名义型：没有顺序之分的类别变量</p>
<p><strong><em>名义型和有序型统称为因子（factor）</em></strong></p>
<p> 函数factor()以整数向量的形式存储类别值</p>
<p><strong><em>要表示有序型变量，需要为函数factor()指定参数order=TRUE</em></strong></p>
<p>对于字符型变量，factor默认的排序方式是按照字母顺序排列。可以指定levels选项来覆盖默认的排序。</p>
<p>数值型变量，<strong><em>用levels和labels来编码因子</em></strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/处理缺失数据的高级方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/处理缺失数据的高级方法/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:53+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="处理缺失数据的高级方法"><a href="#处理缺失数据的高级方法" class="headerlink" title="处理缺失数据的高级方法"></a>处理缺失数据的高级方法</h1><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>1 识别</p>
<p>2 找原因</p>
<p>3 合适的处理</p>
<p>&nbsp;</p>
<h2 id="缺失数据的分类"><a href="#缺失数据的分类" class="headerlink" title="缺失数据的分类"></a>缺失数据的分类</h2><p><strong>完全随机缺失</strong>（MCAR）：与其他变量都不相关。可以认为完整数据是对整体数据集的随机抽样</p>
<p><strong>随机缺失</strong>（MAR）：与其他观测变量有关，但与自己的未观测值无关   </p>
<p>如： 体重较小的动物其做梦时长的缺失较大，可能是因为体重小的动物难以观测。而此缺失与动物的做梦时长本身没有关系</p>
<p><strong>非随机缺失</strong> （NMAR）</p>
<p><strong><em>大部分的缺失值处理方法都假定缺失数据是MCAR或MAR</em></strong></p>
<p>&nbsp;</p>
<h2 id="图形探究缺失数据"><a href="#图形探究缺失数据" class="headerlink" title="图形探究缺失数据"></a>图形探究缺失数据</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">matrixplot(sleep, xlab = colnames(sleep))</span><br></pre></td></tr></table></figure>
<p><code>md.pattern()</code>生成一个以矩阵或数据框展示的缺失值的模式表格</p>
<p><code>aggr()</code>绘制每个变量的缺失值数，和组合变量的缺失值数</p>
<p><code>matrixplot</code></p>
<p><code>marginplot()</code>生成一个散点图</p>
<p>&nbsp;</p>
<h2 id="用相关性探究缺失数据"><a href="#用相关性探究缺失数据" class="headerlink" title="用相关性探究缺失数据"></a>用相关性探究缺失数据</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- as.data.frame(abs(is.na(sleep))) <span class="comment">##有缺失的值为1 无缺失为0</span></span><br><span class="line">head(sleep, n=<span class="number">5</span>)</span><br><span class="line">head(x, n=<span class="number">5</span>)</span><br><span class="line">y &lt;- x[which(apply(x,<span class="number">2</span>,sum)&gt;<span class="number">0</span>)] <span class="comment">##提取含缺失值的变量</span></span><br><span class="line">cor(y)  <span class="comment">##计算缺失变量之间的相关性</span></span><br><span class="line">cor(sleep, y, use=<span class="string">"pairwise.complete.obs"</span>) <span class="comment">##计算缺失与不缺失之间的相关性</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/09/13/5b9a1b80b4e62.jpg" alt></p>
<p>&nbsp;</p>
<h2 id="缺失值的常用处理方法"><a href="#缺失值的常用处理方法" class="headerlink" title="缺失值的常用处理方法"></a>缺失值的常用处理方法</h2><p><strong>行删除法（大部分软件默认）</strong></p>
<p><code>complete.cases()</code>   <code>na.omit</code></p>
<p>&nbsp;</p>
<p><strong>推理法</strong></p>
<p>&nbsp;</p>
<p><strong>多重插补</strong></p>
<p>原理：多值插补的思想来源于贝叶斯估计，认为待插补的值是随机的，它的值来自于已观测到的值。具体实践上通常是估计出待插补的值，然后再加上不同的噪声，形成多组可选插补值。根据某种选择依据，选取最合适的插补值。缺失值通过蒙特卡洛方法填补。</p>
<p><img src="https://i.loli.net/2018/09/13/5b9a2011dd285.jpg" alt></p>
<p>&nbsp;</p>
<p><strong><em>蒙特卡洛基本思想</em></strong>：当所求解问题是某种随机事件出现的概率，或者是某个随机变量的期望值时，通过某种“实验”的方法，以这种事件出现的频率估计这一随机事件的概率，或者得到这个随机变量的某些数字特征，并将其作为问题的解。</p>
<p>工作过程</p>
<p>蒙特卡罗方法的解题过程可以归结为三个主要步骤：构造或描述概率过程；实现从已知概率分布抽样；建立各种估计量。</p>
<p>缺失值的插补通过Gibbs抽样完成。可以自主选择预测模型。</p>
<p>&nbsp;</p>
<p>使用<code>mice()</code>函数</p>
<p><img src="https://pic2.zhimg.com/v2-561283772be13543dee88df86a1afb85_1200x500.jpg" alt="å¤çç¼ºå¤±å¼ä¹å¤éæè¡¥ï¼Multiple Imputationï¼"></p>
<p>&nbsp;</p>
<p>函数mice()首先从一个包含缺失数据的数据框开始，然后返回一个包含多个（默认为5个）完<br>整数据集的对象。每个完整数据集都是通过对原始数据框中的缺失数据进行插补而生成的。由于插<br>补有随机的成分，因此每个完整数据集都略有不同。然后，with()函数可依次对每个完整数据集<br>应用统计模型（如线性模型或广义线性模型），最 后 ，pool()函数将这些单独的分析结果整合为一<br>组结果。最终模型的标准误和p值都将准确地反映出由于缺失值和多重插补而产生的不确定性。</p>
<p>&nbsp;</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">options(digits=<span class="number">3</span>)</span><br><span class="line"><span class="keyword">library</span>(mice)</span><br><span class="line">data(sleep, package=<span class="string">"VIM"</span>)</span><br><span class="line">imp &lt;- mice(sleep, seed=<span class="number">1234</span>)  <span class="comment">##m默认值为5，指有5个填补缺失值的预测值</span></span><br><span class="line">fit &lt;- with(imp, lm(Dream ~ Span + Gest)) <span class="comment">#对5个数据集都做统计分析</span></span><br><span class="line">pooled &lt;- pool(fit) <span class="comment">#将分析结果整合为一组</span></span><br><span class="line">summary(pooled)</span><br><span class="line">imp</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp$imp$Dream   <span class="comment">##提取imp对象的子成分，可以观测到实际的观测值</span></span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
 <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">complete(imp, action=n) <span class="comment">##指定m个完整数据集中的一个来展示</span></span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h2 id="成对删除、简单插补"><a href="#成对删除、简单插补" class="headerlink" title="成对删除、简单插补"></a>成对删除、简单插补</h2><p>建议不要使用</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/主成分分析和因子分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/主成分分析和因子分析/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:53+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="主成分与因子分析"><a href="#主成分与因子分析" class="headerlink" title="主成分与因子分析"></a>主成分与因子分析</h1><h2 id="常用步骤"><a href="#常用步骤" class="headerlink" title="常用步骤"></a>常用步骤</h2><ol>
<li>数据预处理   输入可以是原始矩阵或者相关系数矩阵  原始矩阵要确保没有缺失值</li>
<li>选择因子模型  判断是使用PCA（数据降维）还是EFA（发现潜在结构）</li>
<li>判断选择的主成分或因子的数目</li>
<li>选择主成分或因子</li>
<li>旋转</li>
<li>解释结果</li>
<li>计算主成分或因子得分</li>
</ol>
<p>&nbsp;</p>
<h2 id="主成分分析"><a href="#主成分分析" class="headerlink" title="主成分分析"></a>主成分分析</h2><p>PCA的目标是用一组较少的不相关变量代替大量相关变量，同时尽可能保留初始变量的信<br>息，这些推导所得的变量称为主成分，它们是观测变量的线性组合。如第一主成分为：</p>
<p><img src="https://i.loli.net/2018/09/17/5b9f57b8b86be.jpg" alt></p>
<p>它是k个观测变量的加权组合，对初始变量集的方差解释性最大。第二主成分也是初始变量<br>的线性组合，对方差的解释性排第二，同时与第一主成分正交（不相关）。后面每一个主成分都<br>最大化它对方差的解释程度，同时与之前所有的主成分都正交 。</p>
<p>&nbsp;</p>
<h3 id="判断主成分的个数"><a href="#判断主成分的个数" class="headerlink" title="判断主成分的个数"></a>判断主成分的个数</h3><p>利用<code>fa.parallel()</code>同时对三种特征值判别准则进行评价 </p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fa.parallel(USJudgeRatings[, -<span class="number">1</span>], fa=<span class="string">"pc"</span>, n.iter=<span class="number">100</span>,</span><br><span class="line">             show.legend=<span class="literal">FALSE</span>, main=<span class="string">"Scree plot with parallel analysis"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/09/17/5b9f59c0e6b81.jpg" alt></p>
<p>三个准则：</p>
<ol>
<li>特征值大于1</li>
<li>大于随机数据矩阵推导出的特征值平均值（虚线）</li>
<li>Cattle碎石检验，图形变化最大处以上均可保留</li>
</ol>
<p>&nbsp;</p>
<h3 id="提取主成分"><a href="#提取主成分" class="headerlink" title="提取主成分"></a>提取主成分</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(psych)</span><br><span class="line">pc &lt;- principal(r, nfactors=, rotate=, scores=)</span><br><span class="line"><span class="comment">## r:相关系数矩阵或者原始矩阵</span></span><br><span class="line"><span class="comment">## nfactors：设定主成分数</span></span><br><span class="line"><span class="comment">## rotate：是否旋转</span></span><br><span class="line"><span class="comment">## scores：主成分得分</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/09/17/5b9f75ad0810e.jpg" alt></p>
<p>&nbsp;</p>
<p>PC1栏包含了成分载荷，指观测变量与主成分的相关系数 。成分载荷（ component loadings）可用来解释主成分的含义 。第一主成分（ PC1）与每个变量都高度相关，也就是说，它是一个可用来进行一般性评价的维度。 </p>
<p>&nbsp;</p>
<p>h2栏指成分公因子方差——主成分对每个变量的方差解释度 </p>
<p>u2栏指成分唯一性——方差无法被主成分解释的比例（ 1-h2） </p>
<p>&nbsp;</p>
<h3 id="主成分旋转"><a href="#主成分旋转" class="headerlink" title="主成分旋转"></a>主成分旋转</h3><p>旋转方法有两种：使选择的成分保持不相关（ 正交旋转），和让它们变得相关（ 斜交旋转）。 最流行的正交旋转是方差极大旋转 </p>
<p>&nbsp;</p>
<p>方差极大旋转：它试图对载荷阵的列进行去噪，使得每个成分只是由一组有限的变量来解释（即载荷阵每列只有少数几个很大的载荷，其他都是很小的载荷） </p>
<p>&nbsp;</p>
<h3 id="获取主成分得分"><a href="#获取主成分得分" class="headerlink" title="获取主成分得分"></a>获取主成分得分</h3><p>设置<code>score</code>等于TRUE</p>
<p>当主成分分析基于相关系数矩阵时，原始数据便不可用了，也不可能获取每个观测的主成分得分，但是可以得到用来计算主成分得分的系数 </p>
<p>&nbsp;</p>
<h2 id="探索性因子得分"><a href="#探索性因子得分" class="headerlink" title="探索性因子得分"></a>探索性因子得分</h2><p>协方差矩阵 需要用<code>cov2cor()</code>将其转化为相关系数矩阵 </p>
<p>&nbsp;</p>
<h3 id="判断公共因子数"><a href="#判断公共因子数" class="headerlink" title="判断公共因子数"></a>判断公共因子数</h3><p>类似主成分判断</p>
<p>使用<code>fa.parallel</code></p>
<p>&nbsp;</p>
<h3 id="提取公共因子"><a href="#提取公共因子" class="headerlink" title="提取公共因子"></a>提取公共因子</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fa(r, nfactors, n.obs=, rotate=, scores=, fm=)  <span class="comment">### 使用相关性矩阵时，要设置n.obs</span></span><br><span class="line"><span class="comment">### fm:设定因子化方法（默认极小残差法）</span></span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>统计学家青睐使用最大似然法，因为它有良好的统计性质。不过有时候最大似然法不会收敛，此时使用主轴迭代法效果会很好 .</p>
<p>最大似然法（ ml）</p>
<p>主轴迭代法（ pa）</p>
<p>加权最小二乘法（ wls）</p>
<p>广义加权最小二乘法（ gls）</p>
<p>最小残差法（ minres） </p>
<h3 id="因子旋转"><a href="#因子旋转" class="headerlink" title="因子旋转"></a>因子旋转</h3><p>正交旋转和斜交旋转</p>
<p>正交</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fa.varimax &lt;- fa(correlations, nfactors=<span class="number">2</span>, rotate=<span class="string">"varimax"</span>, fm=<span class="string">"pa"</span>)</span><br></pre></td></tr></table></figure>
<p>使用正交旋转将人为地强制两个因子不相关。</p>
<p>斜交：</p>
<p><code>fa.promax &lt;- fa(correlations, nfactors=2, rotate=&quot;promax&quot;, fm=&quot;pa&quot;)</code> </p>
<p>&nbsp;</p>
<p>对于正交旋转，因子分析的重点在于因子结构矩阵（变量与因子的相关系数），而对于斜交旋转，因子分析会考虑三个矩阵：因子结构矩阵、因子模式矩阵和因子关联矩阵。<br>因子模式矩阵即标准化的回归系数矩阵。它列出了因子预测变量的权重。 因子关联矩阵即因子相关系数矩阵。</p>
<p>&nbsp;</p>
<p>与正交旋转所得因子载荷阵相比，斜交的载荷阵列（因子结构矩阵）的噪音比较大，这是因为之前你允许潜在因子相关。虽然斜交方法更为复杂，但模型将更符合真实数据。 </p>
<p>&nbsp;</p>
<p>使用<code>factor.plot()</code>或<code>fa.diagram()</code>函数，可以绘制正交或者斜交结果的图形 </p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">factor.plot(fa.promax, labels=rownames(fa.promax$loadings))</span><br></pre></td></tr></table></figure>
<p> &nbsp;</p>
<p><img src="https://i.loli.net/2018/09/17/5b9f730cddd73.jpg" alt></p>
<p>&nbsp;</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fa.diagram(fa.promax, simple=<span class="literal">FALSE</span>)</span><br></pre></td></tr></table></figure>
<p>若使simple = TRUE，那么将仅显示每个因子下最大的载荷，以及因子间的相关系数 </p>
<p>&nbsp;</p>
<p><img src="https://i.loli.net/2018/09/17/5b9f739014f81.jpg" alt></p>
<p>&nbsp;</p>
<h2 id="步骤图"><a href="#步骤图" class="headerlink" title="步骤图"></a>步骤图</h2><p><img src="https://i.loli.net/2018/09/17/5b9f74abcc36c.jpg" alt></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/try/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/try/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:45+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="R异常值和错误处理"><a href="#R异常值和错误处理" class="headerlink" title="R异常值和错误处理"></a>R异常值和错误处理</h1><h2 id="try-错误识别"><a href="#try-错误识别" class="headerlink" title="try() 错误识别"></a>try() 错误识别</h2><p>1.将可能会报错的命令行放到try()函数中，并将其赋值到一个变量名fit（可以是任意变量名）中<br>2.如果有错误，将fit将称为一个类型为“try-error”的变量<br>3.可以用R ‘try-error’ %in% class(fit)放置在if()函数中进行判断<br>4.try() 函数一般与next 和 break 进行联用，next跳过本次循环，break跳出循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">library(ConsensusClusterPlus)</span><br><span class="line">i &lt;- 10 </span><br><span class="line">while(i &gt; 3)&#123;</span><br><span class="line">  maxk &lt;- min(i, ncol(distan_matrix)-1)</span><br><span class="line">  i &lt;- i-1</span><br><span class="line">  title &lt;- &quot;./&quot;</span><br><span class="line">  fit &lt;- try(ConsensusClusterPlus(distan_matrix, maxK = maxk, reps = 10, pItem = 0.8, title=title,pFeature = 1, clusterAlg=&quot;kmdist&quot;, seed=1234, plot=&quot;png&quot;))</span><br><span class="line">  if(&quot;try-error&quot; %in% class(fit))</span><br><span class="line">  &#123;</span><br><span class="line">    next</span><br><span class="line">  &#125;else</span><br><span class="line">  &#123;</span><br><span class="line">    Consensus_result = fit</span><br><span class="line">    break</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>原文链接：<a href="https://blog.csdn.net/YJJ18636810884/article/details/83176190" target="_blank" rel="noopener">https://blog.csdn.net/YJJ18636810884/article/details/83176190</a></p>
<p>&nbsp;</p>
<h2 id="使用tryCatch进行简单的错误处理"><a href="#使用tryCatch进行简单的错误处理" class="headerlink" title="使用tryCatch进行简单的错误处理"></a>使用tryCatch进行简单的错误处理</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">result = <span class="keyword">tryCatch</span>(&#123;</span><br><span class="line">    expr</span><br><span class="line">&#125;, <span class="keyword">warning</span> = <span class="keyword">function</span>(w) &#123;</span><br><span class="line">    <span class="keyword">warning</span>-handler-code</span><br><span class="line">&#125;, error = <span class="keyword">function</span>(e) &#123;</span><br><span class="line">    error-handler-code</span><br><span class="line">&#125;, finally = &#123;</span><br><span class="line">    cleanup-code</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/SCENIC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/SCENIC/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:40+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SCENIC"><a href="#SCENIC" class="headerlink" title="SCENIC"></a>SCENIC</h1><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><ul>
<li><p><strong><em>GENIE3</em></strong> to infer the co-expression network</p>
</li>
<li><p><strong><em>RcisTarget</em></strong> for the analysis of transcription factor binding motifs</p>
</li>
<li><p><strong><em>AUCell</em></strong> to identify cells with active gene sets (gene-network) in scRNA-seq data</p>
</li>
</ul>
<h2 id="Workflow"><a href="#Workflow" class="headerlink" title="Workflow"></a>Workflow</h2><ul>
<li>Identify potential targets for each TF based on co-expression</li>
<li>Select potential direct-binding targets (regulons) based on DNA-motif analysis </li>
<li>Analyzing the network activity in each individual cell (<em>AUCell</em>)</li>
<li>Identify stable cell states based on their gene regulatory network activity (cell clustering) and exploring the results</li>
</ul>
<h2 id="Input-expression-matrix"><a href="#Input-expression-matrix" class="headerlink" title="Input: expression matrix"></a>Input: expression matrix</h2><ul>
<li>column: sample (cell)    row: gene</li>
<li><strong>gene-symbol</strong> as rownames</li>
<li>Expression <strong>units</strong>: gene-summarized counts   TPM and FPKM/RPKM are also accepted</li>
</ul>
<blockquote>
<p><font color="#DC143C"> some authors recommend avoiding within sample normalization (i.e. TPM) for co-expression analysis (first step of SCENIC) because they may induce artificial co-variation (<em>Crow et al. (2016)</em>)</font>we have applied SCENIC to datasets using raw (logged) UMI counts, normalized UMI counts, and TPM and all of them provided reliable results (see <em>Aibar et al. (2017)</em>). <font color="#DC143C">The remaining steps of the workflow should not be affected by the expression units/normalization</font>, as the expression is not taken into account for the motif analysis, and AUCell is within-cell ranking-based (wich works as an implicit normalization).</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/Scanpy教程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/Scanpy教程/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:40+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Scanpy"><a href="#Scanpy" class="headerlink" title="Scanpy"></a>Scanpy</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adata</span><br></pre></td></tr></table></figure>
<p>借鉴了知名R包scater的一个函数：<code>plotHighestExprs</code>，绘图用的是python里面的<code>seaborn</code>和<code>matplotlib</code>库。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">current_palette = seaborn.color_palette(<span class="string">"dark"</span>)</span><br><span class="line">seaborn.palplot(current_palette)</span><br></pre></td></tr></table></figure>
<p>​    </p>
<h3 id="subset-clust"><a href="#subset-clust" class="headerlink" title="subset clust"></a>subset clust</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adata_fibro = adata[adata.obs[<span class="string">'leiden'</span>].isin([<span class="string">'2'</span>, <span class="string">'33'</span>, <span class="string">'9'</span>, <span class="string">'3'</span>, <span class="string">'20'</span>, <span class="string">'17'</span>, <span class="string">'0'</span>, <span class="string">'28'</span>])]</span><br></pre></td></tr></table></figure>
<p>​        </p>
<h3 id="rename-subclusters"><a href="#rename-subclusters" class="headerlink" title="rename subclusters"></a>rename subclusters</h3> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">old_to_new = &#123;<span class="number">3</span> :<span class="string">'Fibro1'</span>,</span><br><span class="line">    <span class="number">11</span>: <span class="string">'Fibro2'</span>, <span class="number">20</span>:<span class="string">'Fibro2'</span>,</span><br><span class="line">    <span class="number">12</span>:<span class="string">'Fibro3'</span>, <span class="number">17</span>:<span class="string">'Fibro4'</span>,<span class="number">26</span>:<span class="string">'Fibro4'</span>,</span><br><span class="line">    <span class="number">24</span> : <span class="string">'Fibro3'</span>&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adata_fibro.obs[<span class="string">'leiden'</span>] = adata_fibro.obs[<span class="string">'leiden'</span>].astype(<span class="string">'int'</span>)  </span><br><span class="line"><span class="comment">## 将leiden的cluster号类型转化为int</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">adata_fibro.obs[<span class="string">'new_clusters'</span>] = (</span><br><span class="line">    adata_fibro.obs[<span class="string">'leiden'</span>]</span><br><span class="line">    .map(old_to_new)</span><br><span class="line">    .astype(<span class="string">'category'</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adata_fibro.obs[<span class="string">'leiden'</span>] = adata_fibro.obs[<span class="string">'leiden'</span>].astype(<span class="string">'category'</span>) </span><br><span class="line"><span class="comment">## 改回来</span></span><br></pre></td></tr></table></figure>
<p>​    </p>
<h3 id="delet-MT-genes"><a href="#delet-MT-genes" class="headerlink" title="delet ^MT- genes"></a>delet ^MT- genes</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_mt</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> bool(re.match(<span class="string">'MT-'</span>, n))</span><br><span class="line"></span><br><span class="line">Fibro_top20_selected = [x <span class="keyword">for</span> x <span class="keyword">in</span> Fibro_top20_list <span class="keyword">if</span> <span class="keyword">not</span> bool(re.match(<span class="string">'MT-'</span>, x, flags=<span class="number">0</span>))]</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/R做图/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/R做图/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:40+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="R-做图"><a href="#R-做图" class="headerlink" title="R 做图"></a>R 做图</h1><p>The “whiskers” of the box (the vertical lines extending above and below the box) relate to the range<br> parameter of boxplot, which we let default to the value 1.5 used by R. The height of the box is the<br> interquartile range, the difference between the 75th and 25th quantiles. In this case that difference<br> is 2.8. The whiskers are drawn to be a length of range*2.8 or 1.5*2.8. This shows us roughly how many,<br> if any, data points are outliers, that is, beyond this range of values.</p>
<p><code>abline</code> &lt;=======&gt; adds one or more straight lines through the current plot.</p>
<p><code>rug()</code>  添加灰度条. It automatically adjusted its pocket size to that of the last plot plotted.</p>
<p>rug之后，可以用high和low查看分布</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hist(ppm, col = <span class="string">"green"</span>, breaks = <span class="number">100</span>) <span class="comment">###breaks:the number of buckets to split the data into</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abline(v = median(ppm), col = <span class="string">"magenta"</span>, lwd = <span class="number">4</span>)  <span class="comment">##设置线的位置，宽度和颜色</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">barplot(reg, col = &quot;wheat&quot;, main = &quot;Number of Counties in Each Region&quot;) ###main表格的标题</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">with(pollution, plot(latitude, pm25))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abline(h=<span class="number">12</span>,lwd=<span class="number">2</span>, lty=<span class="number">2</span>)   <span class="comment">### h:水平线高度 lwd宽度   lty虚线还是实线</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title(main = <span class="string">"Old Faithful Geyser data"</span>)  <span class="comment">### 添加标题</span></span><br></pre></td></tr></table></figure>
<p>两种图形设备：向量设备和位图设备</p>
<p>向量设备：用于线条图，以及使用纯色，点较少的图 pdf svg</p>
<p>位图设备：适用于有大量的点，风景，以及基于网络的图形</p>
<p>lattice包很容易实现单变量或多变量的数据可视化，生成的图形为栅栏图。在一个或多个其它变量的条件下，栅栏图可展示某个变量的分布或与其他变量间的关系。 lattice包提供了丰富的图形函数，可生成单变量图形(点图、核密度图、直方图、柱形图和箱线图)、双变量图(散点图、带状图和平行箱线图)和多变量图形(三维图和散点图矩阵)。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xyplot(Life.Exp ~ Income | region, data = state, layout = c(<span class="number">4</span>,<span class="number">1</span>)) <span class="comment">###plotting life expectancy as it depends on income for each region</span></span><br></pre></td></tr></table></figure>
<h2 id="R-base做图"><a href="#R-base做图" class="headerlink" title="R base做图"></a>R base做图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">range(airquality$Ozone, na.rm = TRUE)</span><br></pre></td></tr></table></figure>
<p>boxplot不会自动添加标题和坐标轴标签</p>
<p>hist会自动添加</p>
<p><code>par()$pin</code>   Plot dimensions in inches   图的尺寸</p>
<p><code>par()$fg</code> specifies foreground color</p>
<p><code>par()$bg</code> background color</p>
<p><code>pch</code>: plot character   1代表开环</p>
<p><code>par()$lwd</code> line width</p>
<p><code>par()$lty</code>line type  </p>
<h2 id="Lattice"><a href="#Lattice" class="headerlink" title="Lattice"></a>Lattice</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xyplot(y ~ x | f * g, data)  <span class="comment">##The f and g represent the optional conditioning variables. The * represents interaction between them</span></span><br></pre></td></tr></table></figure>
<p>Lattice适合多变量做图</p>
<p>str函数  紧凑的显示数据内部结构，即对象的内容</p>
<p><code>source</code>  调用函数</p>
<p><code>myedit</code>  查看内容</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sample(colors(), <span class="number">10</span>)  <span class="comment">###查看colors中随机的10个</span></span><br></pre></td></tr></table></figure>
<h2 id="ggplot"><a href="#ggplot" class="headerlink" title="ggplot"></a>ggplot</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qplot(displ, hwy, data =mpg, color = drv, geom = c(<span class="string">"point"</span>, <span class="string">"smooth"</span>))</span><br></pre></td></tr></table></figure>
<p><code>geom</code>画出趋势线</p>
<p><img src="C:\Users\feng\AppData\Local\Temp\1536550364017.png" alt="1536550364017"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qplot(drv, hwy, data=mpg, geom=<span class="string">"boxplot"</span>, color=manufacturers)  <span class="comment">##第一个参数，用来切分数据  第二个参数，想要测量的数据</span></span><br></pre></td></tr></table></figure>
<p><img src="C:\Users\feng\AppData\Local\Temp\1536550506739.png" alt="1536550506739"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qplot(displ, hwy,data=mpg, facets=.~drv)  <span class="comment">##~左边代表行数，右边代表列</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/R转义/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/R转义/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:40+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="R转义"><a href="#R转义" class="headerlink" title="R转义"></a>R转义</h1><p>正则表达式中有一些是特殊字符，比如说刚才的顿号，因此为了匹配这些特殊字符，我们需要对其转义。在Linux命令行里，转义用的是<code>\</code>, 所以可以直接用<code>\.</code>.</p>
<p>但是R<code>\</code> 在字符里被用作转义符号。然后我们需要先把<code>\</code>转义成字符，然后才能进一步转义,<code>\\.</code></p>
<p>如果要匹配<code>\</code> ,就需要<code>\\\\</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/R语言︱数据去重/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/R语言︱数据去重/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:40+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="R语言︱数据去重"><a href="#R语言︱数据去重" class="headerlink" title="R语言︱数据去重"></a>R语言︱数据去重</h1><p>向量 ：unique函数</p>
<p>数据框： duplicated函数</p>
<h1 id="R语言-合并不等长矩阵"><a href="#R语言-合并不等长矩阵" class="headerlink" title="R语言| 合并不等长矩阵"></a>R语言| 合并不等长矩阵</h1><p>merge(df1, df2, by=col1,all=T)</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/R语言 -- list/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/R语言 -- list/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:40+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="R语言-list"><a href="#R语言-list" class="headerlink" title="R语言|list"></a>R语言|list</h1><h2 id="list追加元素"><a href="#list追加元素" class="headerlink" title="list追加元素"></a>list追加元素</h2><p>list也是用c追加元素的</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aa &lt;- list()</span><br><span class="line">bb &lt;- c(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">cc &lt;- c(aa, list(bb))</span><br></pre></td></tr></table></figure>
<p>追加的元素必须也是list</p>
<p>[出处][<a href="https://bbs.csdn.net/topics/391953669?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task]" target="_blank" rel="noopener">https://bbs.csdn.net/topics/391953669?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task]</a></p>
<p>​          </p>
<h2 id="合并list中多个matrix"><a href="#合并list中多个matrix" class="headerlink" title="合并list中多个matrix"></a>合并list中多个matrix</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">do.call(rbind,list)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Reduce(rbind, l)</span><br></pre></td></tr></table></figure>
<p>if you have <code>data.frame</code> and not <code>matrix</code> , is to use <code>rbindlist</code> from <code>data.table</code> package.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbindlist(lapply(l,as.data.frame))</span><br></pre></td></tr></table></figure>
<p>[出处][<a href="https://stackoverflow.com/questions/16110553/combine-a-list-of-matrices-to-a-single-matrix-by-rows]" target="_blank" rel="noopener">https://stackoverflow.com/questions/16110553/combine-a-list-of-matrices-to-a-single-matrix-by-rows]</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">FlorenceXie</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">102</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">FlorenceXie</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
