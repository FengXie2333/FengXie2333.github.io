<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="keep exceeding" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="keep exceeding">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="keep exceeding">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="keep exceeding">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>keep exceeding</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">keep exceeding</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/文献笔记/关节炎--单细胞转录组与质谱流式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/文献笔记/关节炎--单细胞转录组与质谱流式/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:37:18+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="通过整合single-cell-transcriptomics和mass-cytometry定义类风湿关节炎滑膜组织中的炎症细胞状态"><a href="#通过整合single-cell-transcriptomics和mass-cytometry定义类风湿关节炎滑膜组织中的炎症细胞状态" class="headerlink" title="通过整合single-cell transcriptomics和mass cytometry定义类风湿关节炎滑膜组织中的炎症细胞状态"></a>通过整合single-cell transcriptomics和mass cytometry定义类风湿关节炎滑膜组织中的炎症细胞状态</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/单细胞测序/WGCNA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/单细胞测序/WGCNA/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:36:33+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="WGCNA-weighted-gene-co-expression-network-analysis"><a href="#WGCNA-weighted-gene-co-expression-network-analysis" class="headerlink" title="WGCNA(weighted gene co-expression network analysis)"></a>WGCNA(weighted gene co-expression network analysis)</h1><h2 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h2><p><a href="https://www.plob.org/article/10682.html" target="_blank" rel="noopener">https://www.plob.org/article/10682.html</a></p>
<p>WGCNA所分析的数据是芯片数据（需要砸很多芯片，比如若要研究细胞凋亡，那么使用改方法需要实验者提供细胞凋亡各个时期的芯片数据，以了解这一生理过程中细胞内所有基因的表达变化)。</p>
<p>从方法上来讲，WGCNA分为<strong>表达量聚类分析和表型关联</strong>两部分，主要包括基因之间相关系数计算、基因模块的确定、共表达网络、模块与性状关联四个步骤</p>
<p>第一步计算任意两个基因之间的相关系数（Person Coefficient）。为了衡量两个基因是否具有相似表达模式，一般需要设置阈值来筛选，高于阈值的则认为是相似的。但是这样如果将阈值设为0.8，那么很难说明0.8和0.79两个是有显著差别的。因此，<strong>WGCNA分析时采用相关系数加权值，即对基因相关系数取N次幂</strong>，使得网络中的基因之间的连接服从<strong>无尺度网络分布(scale-freenetworks)</strong>，这种算法更具生物学意义。</p>
<p><img src="https://i.loli.net/2018/11/05/5be0059dbceea.jpg" alt></p>
<p>网络的数学名称是图，在图论中对于每一个节点有一个重要概念，即：度。一个点的度是指图中该点所关联的边数。如下图，如果不加以思考，人们很容易认为生活中常见的网络会是一种random network，即每一个节点的度相对平均。然而第二种图，即scale-free network才是一种更稳定的选择。Scale-free network具有这样的特点，即存在少数节点具有明显高于一般点的度，这些点被称为hub。由少数hub与其它节点关联，最终构成整个网络。这样的网络的节点度数与具有该度数的节点个数间服从power distribution。这为我们寻找最佳参数提供了理论依据。     这里做一点扩展，我认为时非常有必要的。只要我们愿意抽象，Scale-free network大量存在于的生活中。人们的社交网络、生物基因蛋白质的相互作用、计算机网络甚至sexually transmitted diseases均有这层关系。生物体选择scale-free network而不是random network是有它进化上的原因的，显然对于scale-free network，少数关键基因执行着主要功能，这种网络具有非常好的鲁棒性，即只要保证hub的完整性，整个生命体系的基本活动在一定刺激影响下将不会受到太大影响，而random network若受到外界刺激，其受到的伤害程度将直接与刺激强度成正比。</p>
<p> <a href="https://www.jianshu.com/p/a2790dc1f010" target="_blank" rel="noopener">https://www.jianshu.com/p/a2790dc1f010</a></p>
<p>第二步通过基因之间的相关系数构建分层聚类树，<strong>聚类树的不同分支代表不同的基因模块</strong>，不同颜色代表不同的模块。基于基因的加权相关系数，将基因按照表达模式进行分类，将模式相似的基因归为一个模块。这样就可以将几万个基因通过基因表达模式被分成了几十个模块，是一个提取归纳信息的过程。</p>
<p><img src="https://i.loli.net/2018/11/05/5be0062feeae6.jpg" alt></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/文献笔记/Nature--外周T细胞扩增预测肿瘤浸润和临床疗效/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/文献笔记/Nature--外周T细胞扩增预测肿瘤浸润和临床疗效/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:36:15+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Nature-外周T细胞扩增预测肿瘤浸润和临床疗效"><a href="#Nature-外周T细胞扩增预测肿瘤浸润和临床疗效" class="headerlink" title="Nature | 外周T细胞扩增预测肿瘤浸润和临床疗效"></a>Nature | 外周T细胞扩增预测肿瘤浸润和临床疗效</h1><p>Title: Peripheral T cell expansion predicts tumor  infiltration and clinical response</p>
<p><a href="https://doi.org/10.1038/s41586-020-2056-8" target="_blank" rel="noopener">Nature, 2020</a></p>
<p>​      </p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p><strong>测序平台</strong>：10X</p>
<p><strong>样本</strong>: </p>
<p>来自14个未经治疗的肿瘤病人，每个病人都取了肿瘤组织和癌旁组织，其中4个病人额外取了外周血        </p>
<p>14个病人分属于4种不同的肿瘤: 非小细胞肺癌(lung)，子宫内膜腺癌(endo), 大肠腺癌(colon), 肾透明腺癌（renal）</p>
<p>样本信息：</p>
<p><img src="https://i.loli.net/2020/03/22/er7iUpG93ZvfMCw.png" alt="snipaste20200322_205305.png"></p>
<p><strong>细胞量</strong>：测序200,626个免疫细胞, 总测序量：541,863,094 mRNA transcripts(其中141,623个Tcell)</p>
<p><strong>重点发现</strong>：</p>
<ul>
<li>在肿瘤组织和癌旁组织中都存在克隆扩增的效应性Tcell</li>
<li>具有这种克隆扩增基因特征的患者对anti-PDL1治疗反应最好。</li>
<li>在肿瘤和癌旁邻近组织中发现的克隆型扩增的效应性Tcell也可以在外周血中检测到，说明这种Tcell有潜力成为筛选anti-PDL1响应病人的新指标</li>
<li>肿瘤浸润Tcell（尤其是anti-PDL1效果良好的病人中）从肿瘤外的部位补充新鲜的，未耗竭的Tcell。这表明这部分病人肿瘤免疫循环持续活跃      </li>
</ul>
<p>​          </p>
<h2 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h2><ul>
<li><p><strong>单细胞建库：</strong>10x，Chromium Single Cell 5′ Library， scRNA+scTCR</p>
</li>
<li><p><strong>数据分析</strong>：</p>
<p>主要使用Seurat 3.0.2</p>
<ul>
<li>使用Seurat中的<code>SCTransform</code>进行校正</li>
<li>使用<code>IntegrationAnchors</code>和<code>IntegrateData</code>整合不同批次的数据（dimensions：30）</li>
<li>聚类降维：<code>FindNeighbours</code>和<code>FindClusters</code>(resolution: 1.6)</li>
<li>寻找每个cluster的biomarker：<code>FindMarker</code>(logfc.threshold默认的参数是0.25，由于这个阈值，某些cluster找到的marker少于20个，所以调整到0.10)</li>
</ul>
</li>
<li><p><strong>类的注释</strong>：常规marker + <code>FindMarkers</code>+singleR</p>
<p>CD3E表达量和TCR clonotype均高的认为是Tcell, 两者都低的认为是non-Tcell</p>
</li>
<li><p><strong>寻找差异基因：</strong></p>
<ul>
<li>寻找每个cluster的biomarker：函数<code>FindMarkers</code> (logfc.threshold默认的参数是0.25，由于这个阈值，某些cluster找到的marker少于20个，所以调整到0.10)</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>下游分析：</strong>（针对转录组数据的分析主要在附件里，本文的重点在于TCR分析）</p>
<ul>
<li><p>GSEA</p>
</li>
<li><p>与已有数据做对比: R包singleR， 从已发表的数据中提取基因集作为参照</p>
<ul>
<li><p>​    Guo, X. et al. Global characterization of T cells in non-small-cell lung cancer by single-<br>cell sequencing. Nat. Med. 24, 978–985 (2018).</p>
</li>
<li><p>​    Zhang, L. et al. Lineage tracking reveals dynamic relationships of T cells in colorectal<br>cancer. Nature 564, 268–272 (2018).</p>
</li>
<li><p>​    Yost, K. E. et al. Clonal replacement of tumor-specific T cells following PD-1 blockade.<br>Nat. Med. 25, 1251–1259 (2019).</p>
</li>
</ul>
</li>
<li><p>resident memory T cells， terminal versus stem-like exhaustion Tcell的区分：</p>
<p>文献中使用的marker与自己的数据overlap后，计算基因集的zscore</p>
</li>
<li><p>整合转录组和TCR数据</p>
</li>
<li><p>临床实验数据分析，计算clone与预后的关系</p>
</li>
</ul>
</li>
</ul>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><h3 id="Extended-Data-Fig-2"><a href="#Extended-Data-Fig-2" class="headerlink" title="Extended Data Fig. 2"></a>Extended Data Fig. 2</h3><p><strong>a</strong>: 很多clonotype在肿瘤和癌旁组织（NAT）中共享</p>
<p>dual-expanded clones: 既在肿瘤中，又在NAT中表达的clone</p>
<p>singletons：只在一个细胞上表达的clone</p>
<p>tumor multiples: 至少在两个细胞上表达， 但只在肿瘤中表达的clone</p>
<p>NAT multiples：至少在两个细胞上表达， 但只在癌旁组织中表达的clone</p>
<p><strong>b</strong>: 大部分clonotypes属于singletons</p>
<p>9-18%的clonotypes属于multiples和dual-expanded clones</p>
<p><strong>c</strong>: dual-expanded clones在某些组织中是主要的克隆类型</p>
<p><strong>d</strong>: 通过对NAT和肿瘤样本中克隆细胞的计数分析，发现不同患者的克隆扩增行为不同</p>
<p>在一些患者,比如Colon1，dual-expanded clones沿着主对角线排列，即在肿瘤和NAT中双扩增克隆的细胞比例近似相等，提示由类似的克隆类型导致的肿瘤和NAT间的协调或平行过程，相反，在其他患者中，双扩增克隆从主对角线上分散，表明每个克隆在肿瘤和NAT室中具有独立的扩增、迁移或消耗模式。</p>
<p><strong>e</strong>: 根据克隆在组织和血液中的扩增程度对克隆进行分类 （对应Fig1b）</p>
<p>​        </p>
<p><img src="https://i.loli.net/2020/03/23/C2Tp3Ber7wlPzYh.png" alt="snipaste20200323_100611.png"></p>
<p>​         </p>
<h3 id="Fig1"><a href="#Fig1" class="headerlink" title="Fig1"></a>Fig1</h3><p><strong>a</strong>: 4个有blood测序数据的病人的克隆扩增散点图</p>
<p>点的大小表示血液克隆的大小</p>
<p>颜色代表不同的组织扩增模式</p>
<p><strong>b</strong>：克隆扩增模式图解：</p>
<p>血液中的single称为blood non-expanded, multiple称为 blood-expanded</p>
<p>不在血液中表达的clone称为blood-independent</p>
<p><strong>c &amp; d</strong> : 在具有双扩增克隆比例较多的患者中，组织中的双扩增克隆在血液中也存在扩增</p>
<p><strong>f-i</strong>: 外周血中的扩增与肿瘤浸润具有正相关</p>
<p><img src="https://i.loli.net/2020/03/23/MLfEV4DeK5WHY7S.png" alt="snipaste20200323_102756.png"></p>
<p>​          </p>
<h3 id="Fig2"><a href="#Fig2" class="headerlink" title="Fig2:"></a>Fig2:</h3><p><strong>a</strong>：转录组数据聚类降维umap图</p>
<p><strong>b</strong>：转录组分群对应的克隆表达模式</p>
<ul>
<li>CD4和CD8表达不同的克隆模式</li>
<li>细胞亚群8.1、8.2和8.3 的克隆大部分是双扩增型</li>
</ul>
<p><strong>c</strong>：将细胞亚群映射到血液样本的克隆数据中发现许多在NAT和肿瘤中表现出一致的克隆（parallel dual expansion）主要来源于8.1-Teff细胞,8.3b-Trm也存在少量parallel dual expansion.</p>
<p><strong>d</strong>: 8.1-Teff是唯一在blood expansion和dual-expanded的clone size间有统计学显著关系的克隆，表明它们在外周克隆扩增和肿瘤浸润中起主导作用。</p>
<p><img src="https://i.loli.net/2020/03/23/sjL1YX5nkVMhW6q.png" alt="snipaste20200323_212503.png"></p>
<p>​       </p>
<h3 id="Fig3"><a href="#Fig3" class="headerlink" title="Fig3"></a>Fig3</h3><p>由于本文数据只获取了静态的数据，不能反映动态变化的过程。所以本文作者分析了已发表的基底细胞癌的免疫治疗前后的Tcell数据</p>
<p><strong>a</strong>: 肿瘤和血液中clone size相关性</p>
<p>结论：在novel CD8中，治疗后的克隆大小和治疗前血液中的转录数显著相关，说明部分治疗后新出现的CD8 clone来源于外周血</p>
<p><strong>b</strong>: 血液克隆多样性与novel克隆和novel cells的关系</p>
<p>尽管不同患者在新克隆的数量方面存在显著差异，但这些差异与外周血克隆多样性程度有关，进一步支持了外周血和肿瘤内克隆扩增之间的关系</p>
<p><strong>c</strong>: 耗竭性Tcell和非耗竭性Tcell的克隆特征</p>
<p>根据肿瘤克隆在治疗前是否与血液共享TCR序列，进一步分类,分为区分血液独立型（blood-independent）克隆和血液相关型（blood-associated）克隆。在两个具有最大血液克隆多样性的患者中，血液clone size和衰竭表型之间具有相关性： non-exhausted clones更可能与blood-associated clone相关，而 exhausted clones更有可能与blood-independent clone相关。此外，与血液相关的未耗尽克隆在治疗后肿瘤中的克隆大小显著大于非血液相关克隆。由此推测可能存在的两种克隆扩增的model（1）独立于血液的局部扩增产生耗竭性T细胞；（2）来自相对较新血液的浸润过程将新的、未耗尽的克隆体引入肿瘤。</p>
<p><img src="https://i.loli.net/2020/03/24/7vLUmYSJytWrDkI.png" alt="snipaste20200324_113626.png"></p>
<p>​       </p>
<h3 id="Fig4"><a href="#Fig4" class="headerlink" title="Fig4"></a>Fig4</h3><p><strong>a</strong>: 肿瘤多发性和双重扩增的基因特征与更好的PFS相关</p>
<p><strong>b</strong>: 考虑CD8表达量的不同，使用CD8A表达和tissue expansion signature score进行双变量分析</p>
<p><img src="https://i.loli.net/2020/03/24/j4iWSrg6Yn9lyQL.png" alt="snipaste20200324_114034.png"></p>
<p>​        </p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>本文最重要的发现是：来自外周血的未耗竭T细胞和耗竭性T细胞克隆可能是解释癌症免疫治疗疗效异质性的关键因素。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/文献笔记/Immunity--TCF1决定CD8 T细胞命运/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/文献笔记/Immunity--TCF1决定CD8 T细胞命运/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:36:15+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Immunity-TCF1决定CD8-T细胞命运"><a href="#Immunity-TCF1决定CD8-T细胞命运" class="headerlink" title="Immunity | TCF1决定CD8 T细胞命运"></a>Immunity | TCF1决定CD8 T细胞命运</h1><p>Title: TCF-1-Centered Transcriptional Network Drives an Effector versus Exhausted CD8 T Cell-Fate Decision</p>
<p>Immunity, 2019.09    <a href="https://doi.org/10.1016/j.immuni.2019.09.013" target="_blank" rel="noopener">https://doi.org/10.1016/j.immuni.2019.09.013</a></p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p><strong>测序平台</strong>：10X</p>
<p><strong>样本</strong>: </p>
<p>来源于LCMV感染小鼠的初始T细胞(naive T)， 效应T细胞(Teff), 早期耗竭T细胞（Tex）</p>
<p><img src="https://i.loli.net/2020/03/15/SRFeVxXMir9zCYl.png" alt="snipaste20200315_232129.png"></p>
<p><strong>细胞量</strong>：5*10^3</p>
<p><strong>重点发现</strong>：</p>
<ul>
<li>小鼠慢性感染和肿瘤发生早期，存在着耗竭性T细胞前体和类效应性T细胞的二元分化机制</li>
<li>TCF1促进耗竭性T细胞前体分化， 抑制效应T细胞分化</li>
<li>PD-1维持TCF1+Tex前体细胞的数量</li>
<li>TCF1的作用机制是上调下游Eomes和c-Myb的表达</li>
</ul>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><ul>
<li><strong>单细胞建库：</strong> 10X</li>
<li><strong>质控：</strong><ul>
<li>删除所有线粒体基因</li>
<li>保留表达基因数大于1000的细胞</li>
</ul>
</li>
<li><strong>normalization</strong> ：R包 <code>Scran</code></li>
<li><strong>数据分析</strong>：<ul>
<li><code>MAST</code>: 进行细胞群间差异基因分析</li>
<li><code>Monocle-2</code>,<code>TSCAN</code>, <code>STIP</code>:假时序分析</li>
</ul>
</li>
<li><strong>下游分析：</strong><ul>
<li>假时序分析</li>
<li>ATAC-Seq</li>
<li>GO分析：挑选每群top100的基因。工具：DAVID网站</li>
</ul>
</li>
</ul>
<p>​       </p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><ul>
<li>在急性感染或疫苗接种过程中，初始CD8 T细胞被激活并分化为一个效应T细胞池，其中含有KlRG1hi终末效应（Teff）细胞和KlRG1LoCD127Hi记忆前体（Tmp）细胞。Teff细胞数量一般是Tmp的5-20倍。KlRG1hi终末效应细胞在几周内迅速耗竭， 而Tmp细胞则转化为长效记忆细胞</li>
<li>在慢性感染和肿瘤中，主要为 KLRG1Lo 耗竭性CD8细胞</li>
<li>谱系追踪显示，慢性感染过程中KLRG1HiTeff生存能力差，无法转化为Tex</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/文献笔记/Immunity--HPV+和HPV-头颈癌患者免疫图谱/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/文献笔记/Immunity--HPV+和HPV-头颈癌患者免疫图谱/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:36:15+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Immunity-HPV-和HPV-头颈癌患者免疫图谱"><a href="#Immunity-HPV-和HPV-头颈癌患者免疫图谱" class="headerlink" title="Immunity | HPV+和HPV-头颈癌患者免疫图谱"></a>Immunity | HPV+和HPV-头颈癌患者免疫图谱</h1><p>Title: Immune Landscape of Viral- and Carcinogen-Driven Head and Neck Cancer </p>
<p>Immunity, 2020.01    <a href="https://doi.org/10.1016/j.immuni.2019.11.014" target="_blank" rel="noopener">https://doi.org/10.1016/j.immuni.2019.11.014</a>         </p>
<p>&nbsp;      </p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p><strong>测序平台</strong>：10X</p>
<p><strong>样本</strong>: </p>
<ul>
<li><p>​    实验组：来自18个HPV– HNSCC 病人 和8个HPV+ HNSCC 病人的肿瘤组织及外周血的免疫细胞 （HNSCC：头颈癌）</p>
</li>
<li><p>​    对照组：来自5个睡眠呼吸暂停综合征患者的扁桃体组织和6份来自健康人的PBMC的免疫细胞</p>
</li>
</ul>
<p><strong>细胞量</strong>：经过质控，剩余131,224 个免疫细胞</p>
<p><strong>重点发现</strong>：</p>
<ul>
<li><p>HPV-HNSCC和HPV+HNSCC肿瘤微环境中免疫细胞转录组存在明显差异。主要差异体现在CD4辅助Tcell和Bcell。两种肿瘤中，CD8+Tcell以及Treg cell转录组相似</p>
</li>
<li><p>利用多光谱成像揭示HPV+病人中存在与疾病进展相关的免疫结构（TLSs）</p>
</li>
<li><p>TCGA数据显示, 滤泡辅助Tcell与头颈癌预后相关        </p>
<p>&nbsp;      </p>
</li>
</ul>
<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><ul>
<li>头颈癌诱因：<ul>
<li>暴露于酒精或烟草等致癌物，引发基因改变</li>
<li>HPV感染</li>
</ul>
</li>
<li>HPV+HNSCC  预后更好</li>
<li>HPV+ HNSCC  肿瘤微环境中Bcell比例更高，HPV– HNSCC 中功能异常的CD8 Tcell比例更高</li>
<li>PD1或PDL1阻断疗法只对大约20%-30%的HNSCC病人有效        </li>
</ul>
<p>&nbsp;      </p>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><ul>
<li><p><strong>单细胞建库：</strong>Chromium Single Cell 30 Reagent (V2 Chemistry) , 10X</p>
</li>
<li><p><strong>质控：</strong></p>
<ul>
<li>保留基因数在200-20,000之间的细胞</li>
<li>保留在超过1%细胞中表达，且表达量大于3 counts的基因</li>
<li>质控后，剩余131,224 个细胞，每个细胞平均表达1,262个基因</li>
</ul>
</li>
<li><p>使用TPM用于下游分析</p>
</li>
<li><p>Library size <strong>normalization</strong> ：log((每个细胞中某基因表达量*该细胞中基因总表达量)/10000 + 1)</p>
</li>
<li><p><strong>数据分析</strong>：</p>
<ul>
<li>数据的scale使用了Seurat软件</li>
<li>使用了两种降维方法： FItSNE  &amp; Diffusion Map（用于伪时序分析）</li>
<li>聚类方法：DRAGON （DeteRministic Annealing Gaussian mixture mOdel clusteriNg algorithm ）</li>
</ul>
</li>
<li><p><strong>类的注释</strong>：利用常规使用的marker</p>
</li>
<li><p><strong>寻找差异基因：</strong></p>
<ul>
<li>方法：Wilcoxon rank sum test </li>
<li>标准：在大于10%的细胞中表达，且差异倍数（logFC）大于0.5</li>
</ul>
</li>
<li><p><strong>下游分析：</strong></p>
<ul>
<li><p>利用R包SingleSeqGset 进行基因富集分析</p>
</li>
<li><p>利用Diffusion Map进行伪时序分析</p>
</li>
<li><p>计算亚群及样本间相关性</p>
</li>
<li><p>利用CellTalker，探索细胞亚群间cross-talk</p>
</li>
<li><p>TCGA数据分析        </p>
<p>&nbsp;        </p>
</li>
</ul>
</li>
</ul>
<h3 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h3><h4 id="Fig1"><a href="#Fig1" class="headerlink" title="Fig1:"></a>Fig1:</h4><ul>
<li>A: 流程</li>
<li>B：相关性分析: PBMC，TIL和扁桃体淋巴细胞以及HPV+和HPV- TIL在转录组上存在明显差异</li>
<li>C、D、E：聚类及注释</li>
<li>F： HPV-和HPV+ TIL相比比，Bcell，髓系细胞，CD4+ Tcon转录组差异较大，Treg和CD8细胞则比较相似</li>
</ul>
<p><img src="https://i.loli.net/2020/03/01/s79hAHJDnwilQoR.png" alt="snipaste20200301_222902.png"></p>
<p>​                    </p>
<h4 id="Fig2-CD8-Tcell"><a href="#Fig2-CD8-Tcell" class="headerlink" title="Fig2: CD8 Tcell"></a>Fig2: CD8 Tcell</h4><ul>
<li><p>B : cluster 1-4, 8主要来源于TIL；cluster 5-7由PBMC、扁桃体和TIL的混合组成</p>
</li>
<li><p>C: 每个cluster的marker   D：各亚群marker富集分析（biological functions）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cluster 1 was associated with cycling cells (e.g., MKI67); cluster 2 was associated with interferon (IFN) response genes (e.g., ISG15); clusters 3 and 4 expressed checkpoint markers associated with exhaustion (e.g., PDCD1 [gene for PD-1] andCTLA4andHAVCR2[gene for TIM3]); cluster 5 was generally quiescent and expressed low levels of effector molecules (e.g., GZMH and KLRD1); cluster 6 expressed markers associated with naive or memory cells (e.g., CCR7 andCD27); cluster 7 expressed genes associated with early activation (e.g., JUNB and FOSB); and cluster 8 expressed genes associated with effector function (e.g., KLRG1 and GZMH)</span><br></pre></td></tr></table></figure>
</li>
<li><p>E： 时序分析（diffusion map）显示PBMC和TIL间存在转化关系，Fig2F显示HPV+，HPV- CD8 Tcell转录组重叠</p>
<ul>
<li>DC1： 主要与终末分化表型相关（沿着DC1，LAG3, CTLA4, PDCD1 (gene for PD1) and HAVCR2 (gene for TIM3)表达量逐渐升高），除此之外还与细胞粘附和Bcell招募相关（ENTPD1和CXCL13）</li>
<li>DC2：主要与记忆表型相关（CD27, CCR7, EOMES）          </li>
</ul>
<p>​      </p>
</li>
</ul>
<p><img src="https://i.loli.net/2020/03/02/YCUXxmiGksR2H5M.png" alt="snipaste20200302_231255.png"></p>
<p>​                      </p>
<h4 id="Fig3-CD4-Tcell"><a href="#Fig3-CD4-Tcell" class="headerlink" title="Fig3: CD4+ Tcell"></a>Fig3: CD4+ Tcell</h4><p>分析思路类似于CD8</p>
<p>主要结论：</p>
<p><strong>CD4</strong>（Fig3A-Fig3E）</p>
<ul>
<li>扁桃体和TIL CD4 Tcell富集了TFH和TH1相关基因</li>
<li>HPV+ TIL富集更多的TFH基因</li>
<li>HPV+ TIL和HPV- TIL位于不同的分化界面上。CD4分化轨迹经历共同的起始阶段后，分别向cluster1和cluster7两个不同的终末分化状态转化。cluster1 主要来源于HPV+TIL，富集TFH相关基因。cluster7主要来源HPV- TIL，主要富集激活，IFN response，记忆相关基因</li>
</ul>
<p><strong>Treg</strong>（Fig3F-Fig3J）</p>
<ul>
<li>HPV+ Treg和HPV- Treg在时序上存在细微差异。分化早期，来自HPV-的Treg更多</li>
<li>分化早期的Treg富集IFN-response 基因（IFITM1, IFIT1, IFIT3, and ISG20）, 晚期主要富集TNF超家族基因（GITR， OX40，41BB），映证了TNF超家族基在维持Treg功能方面的作用        </li>
</ul>
<p>​         </p>
<p><img src="https://i.loli.net/2020/03/02/INohiMVAtu26Lb4.png" alt="snipaste20200302_231255.png"></p>
<p>​             </p>
<h4 id="Fig4：HPV-肿瘤微环境中发现生发中心（GC）B-cell"><a href="#Fig4：HPV-肿瘤微环境中发现生发中心（GC）B-cell" class="headerlink" title="Fig4：HPV+ 肿瘤微环境中发现生发中心（GC）B cell"></a>Fig4：HPV+ 肿瘤微环境中发现生发中心（GC）B cell</h4><ul>
<li>HPV+ 肿瘤微环境富含GC Bcell， 包括位于暗区的高增殖B细胞，和位于亮区的非增殖B细胞</li>
<li>HPV- 中的Bcell主要浆细胞和记忆Bcell，原因可能是因为缺乏TFH细胞的辅助      </li>
</ul>
<p>​         </p>
<p><img src="https://i.loli.net/2020/03/06/R8imdWCqcajJh9x.png" alt="snipaste20200306_143403.png"></p>
<p>​                     </p>
<h4 id="Fig5-Myeloid"><a href="#Fig5-Myeloid" class="headerlink" title="Fig5: Myeloid"></a>Fig5: Myeloid</h4><ul>
<li><p>PMBC中的髓系向肿瘤中髓系细胞转化</p>
</li>
<li><p>巨噬细胞不能简单分成M1和M2，它们之间存在连续变化的过渡关系（基本每种肿瘤的免疫细胞单细胞测序文章都提到了在这一点，没什么新意）       </p>
</li>
</ul>
<p><img src="https://i.loli.net/2020/03/06/b2f7eFx3gqm6acR.png" alt="snipaste20200306_155518.png">      </p>
<p>​          </p>
<h3 id="Fig6-免疫细胞间的cross-talk"><a href="#Fig6-免疫细胞间的cross-talk" class="headerlink" title="Fig6: 免疫细胞间的cross-talk"></a>Fig6: 免疫细胞间的cross-talk</h3><p>R包：celltalker</p>
<p>肿瘤组织中免疫细胞之间的cross-talk比癌旁和PBMC多</p>
<p>HPV+和HPV-肿瘤微环境中都存在独特的相互关系</p>
<p><img src="https://i.loli.net/2020/03/06/qrNYPehyVCE3dg7.png" alt="snipaste20200306_155518.png">      </p>
<p>​       </p>
<h4 id="Fig7：免疫荧光揭示独特的空间结构"><a href="#Fig7：免疫荧光揭示独特的空间结构" class="headerlink" title="Fig7：免疫荧光揭示独特的空间结构"></a>Fig7：免疫荧光揭示独特的空间结构</h4><ul>
<li>A：基于免疫细胞的组成不同，对不同slide进行了分层聚类</li>
<li>B-F：根据空间结构上的邻近程度，推测细胞细胞之间相互作用的几率。在B细胞频率最高的簇中，B细胞与其他B细胞相互作用的几率最高，其次是与CD4+Tconv细胞相互作用。并且，在5类cluster中，发现了反映三级淋巴结结构（TLSs）的免疫细胞组织模式</li>
<li>G-H: 根据空间结构上的推测出的相互作用关系，比较HPV+和HPV-肿瘤中Bcell与CD4+ Tconv间相互关系的差异。发现只有在HPV+肿瘤中存在GC Bcell与TFH的相互关系</li>
<li>I：利用TCGA数据库发现，在HPV+头颈癌病人中，TFH 基因集表达量高预示着更好的预后</li>
</ul>
<p><img src="https://i.loli.net/2020/03/06/16HfsSbwMKBcdTW.png" alt="snipaste20200306_155518.png"></p>
<h3 id="总结一下"><a href="#总结一下" class="headerlink" title="总结一下"></a>总结一下</h3><p>本文主要揭示HPV+和HPV-头颈癌病人免疫微环境的差异。其中最重要的差异在于HPV+病人中富集TFH，并存在TLSs。且TCGA分析显示TFH与预后相关。</p>
<p>总体来讲，本文的亮点在于实验设计上。取样取的很全面。既包括肿瘤组织，PBMC，又包括扁桃体。然后各种组织比来比去，总会找出很多差异的。至于文中用到的各种生信分析手段基本都是常规使用的分析套路。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/在Jupyter中安装R内核/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/在Jupyter中安装R内核/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:53+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="在Jupyter中安装R内核"><a href="#在Jupyter中安装R内核" class="headerlink" title="在Jupyter中安装R内核"></a>在Jupyter中安装R内核</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">'IRkernel'</span>)</span><br><span class="line">IRkernel::installspec()  <span class="comment"># to register the kernel in the current R installation</span></span><br></pre></td></tr></table></figure>
<p>重启jupyter</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/下载cBioPortal中的文章相关数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/下载cBioPortal中的文章相关数据/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:53+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="使用cgdsr下载cBioPortal数据"><a href="#使用cgdsr下载cBioPortal数据" class="headerlink" title="使用cgdsr下载cBioPortal数据"></a>使用cgdsr下载cBioPortal数据</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(cgdsr)</span><br><span class="line"></span><br><span class="line">mycgds = CGDS(<span class="string">"http://www.cbioportal.org/"</span>)</span><br><span class="line"></span><br><span class="line">class(mycgds)</span><br><span class="line"></span><br><span class="line">tt &lt;- getCancerStudies(mycgds)</span><br><span class="line"></span><br><span class="line">tt[which(tt$name == <span class="string">'Breast Invasive Carcinoma (TCGA, PanCancer Atlas)'</span>),]</span><br><span class="line"></span><br><span class="line">study_id &lt;- tt[which(tt$name == <span class="string">'Breast Invasive Carcinoma (TCGA, PanCancer Atlas)'</span>),][,c(<span class="number">1</span>,<span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line">profiles &lt;- getGeneticProfiles(mycgds, study_id$cancer_study_id)</span><br><span class="line"></span><br><span class="line">cases &lt;- getCaseLists(mycgds, study_id$cancer_study_id)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/图形初阶/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/图形初阶/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:53+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="图形初阶"><a href="#图形初阶" class="headerlink" title="图形初阶"></a>图形初阶</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opar &lt;- par(no.readonly=<span class="literal">TRUE</span>) <span class="comment"># make a copy of current settings</span></span><br></pre></td></tr></table></figure>
<p><code>abline</code> 添加参考线</p>
<p><code>text</code>  <code>mtext</code>  添加文本标注</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">legend(<span class="string">"topleft"</span>, inset=<span class="number">.05</span>, title=<span class="string">"Drug Type"</span>, c(<span class="string">"A"</span>,<span class="string">"B"</span>),</span><br><span class="line">       lty=c(<span class="number">1</span>, <span class="number">2</span>), pch=c(<span class="number">15</span>, <span class="number">17</span>), col=c(<span class="string">"red"</span>, <span class="string">"blue"</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">par(mfrow=c(<span class="number">2</span>,<span class="number">2</span>)) <span class="comment"># 按行填充2行2列</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attach</span>(mtcars)</span><br><span class="line">layout(matrix(c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>), <span class="number">2</span>, <span class="number">2</span>, byrow = <span class="literal">TRUE</span>), widths=c(<span class="number">3</span>, <span class="number">1</span>), heights=c(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">hist(wt)</span><br><span class="line">hist(mpg)</span><br><span class="line">hist(disp)</span><br><span class="line"><span class="keyword">detach</span>(mtcars)  <span class="comment">###第一个图占一行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title(main,sub,col.main,col.sub)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot(dose, drugA, type=<span class="string">"b"</span>)  <span class="comment">###同时输出点和线</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">par(lty=<span class="number">2</span>, pch=<span class="number">17</span>)            <span class="comment"># change line type and symbol</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Adding text, lines, and symbols  添加文本，自定义坐标轴</span></span><br><span class="line">plot(dose, drugA, type=<span class="string">"b"</span>,  </span><br><span class="line">     col=<span class="string">"red"</span>, lty=<span class="number">2</span>, pch=<span class="number">2</span>, lwd=<span class="number">2</span>,</span><br><span class="line">     main=<span class="string">"Clinical Trials for Drug A"</span>, </span><br><span class="line">     sub=<span class="string">"This is hypothetical data"</span>, </span><br><span class="line">     xlab=<span class="string">"Dosage"</span>, ylab=<span class="string">"Drug Response"</span>,</span><br><span class="line">     xlim=c(<span class="number">0</span>, <span class="number">60</span>), ylim=c(<span class="number">0</span>, <span class="number">70</span>))</span><br></pre></td></tr></table></figure>
<p><code>ann=FALSE</code>禁用默认标题 或者用 <code>main=&quot;&quot;</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/气泡图/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/气泡图/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:53+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Seurat气泡图"><a href="#Seurat气泡图" class="headerlink" title="Seurat气泡图"></a>Seurat气泡图</h1><h3 id="create-a-simulated-grouping-variable"><a href="#create-a-simulated-grouping-variable" class="headerlink" title="create a simulated grouping variable"></a>create a simulated grouping variable</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pbmc@meta.data$orig.ident &lt;- c(rep(<span class="string">"TAO"</span>, <span class="number">1044</span>), rep(<span class="string">"NC"</span>, <span class="number">5801</span>))</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="translate-cluster-numbers-to-cell-names"><a href="#translate-cluster-numbers-to-cell-names" class="headerlink" title="translate cluster numbers to cell names"></a>translate cluster numbers to cell names</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">current.cluster.ids &lt;- c(c(<span class="number">0</span>,<span class="number">13</span>),c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>),c(<span class="number">2</span>),c(<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">11</span>),c(<span class="number">9</span>,<span class="number">10</span>),c(<span class="number">12</span>),c(<span class="number">5</span>))</span><br><span class="line">new.cluster.ids &lt;-c(rep(<span class="string">"adipocyte"</span>,<span class="number">2</span>),rep(<span class="string">"fibroblast"</span>,<span class="number">3</span>),<span class="string">"myocyte"</span>,rep(<span class="string">"APC"</span>,<span class="number">4</span>),rep(<span class="string">"lymphocytes"</span>,<span class="number">2</span>),<span class="string">"neutrophil"</span>,<span class="string">"epithelial"</span>)</span><br><span class="line">pbmc@ident &lt;- plyr::mapvalues(x = pbmc@ident, from = current.cluster.ids, to = new.cluster.ids)</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h3 id="remove-clusters-that-are-not-of-interest"><a href="#remove-clusters-that-are-not-of-interest" class="headerlink" title="remove clusters that are not of interest"></a>remove clusters that are not of interest</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pbmc_rm &lt;- SubsetData(pbmc, ident.remove = c(<span class="string">"myocyte"</span>,<span class="string">"neutrophil"</span>))</span><br></pre></td></tr></table></figure>
<h6 id="Seurat对象，不能直接用subset取子集"><a href="#Seurat对象，不能直接用subset取子集" class="headerlink" title="Seurat对象，不能直接用subset取子集"></a>Seurat对象，不能直接用subset取子集</h6><p>&nbsp;</p>
<h3 id="SplitDotPlotGG"><a href="#SplitDotPlotGG" class="headerlink" title="SplitDotPlotGG"></a>SplitDotPlotGG</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">markers.to.plot &lt;- c(<span class="string">"CD3D"</span>,<span class="string">"CD19"</span>,<span class="string">"CD27"</span>,<span class="string">"TBX21"</span>,<span class="string">"STAT1"</span>,<span class="string">"GATA3"</span>,<span class="string">"STAT6"</span>,<span class="string">"RORA"</span>,<span class="string">"STAT3"</span>,<span class="string">"AHR"</span>,<span class="string">"IL2RA"</span>,<span class="string">"BCL6"</span>,<span class="string">"SPI1"</span>,<span class="string">"CD14"</span>,<span class="string">"CD68"</span>,<span class="string">"CD1C"</span>,<span class="string">"THBD"</span>,<span class="string">"NCAM1"</span>,<span class="string">"FCGR3A"</span>,<span class="string">"PECAM1"</span>,<span class="string">"MCAM"</span>,<span class="string">"CD34"</span>,<span class="string">"COL1A1"</span>)</span><br><span class="line"></span><br><span class="line">sdp &lt;- SplitDotPlotGG(object=pbmc_rm, grouping.var = <span class="string">"orig.ident"</span>, genes.plot = rev(markers.to.plot), cols.use = c(<span class="string">"blue"</span>, <span class="string">"red"</span>), x.lab.rot = <span class="literal">T</span>, plot.legend = <span class="literal">T</span>, dot.scale = <span class="number">8</span>, do.return = <span class="literal">T</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/10/22/5bcd81f459509.png" alt></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/28/R语言/面向对象/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FlorenceXie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="keep exceeding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/28/R语言/面向对象/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-28T10:35:53+08:00">
                2020-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h1><p>####《R语言实战学习笔记》####</p>
<p>R使用对象的类来确定当一个泛型函数被调用时采取什么样的行动 </p>
<p>&nbsp;</p>
<p>为了列出可获得的S3泛型函数，可以使用<code>methods()</code>函数：</p>
<p><img src="https://i.loli.net/2018/12/08/5c0bb9046fda4.jpg" alt></p>
<p>函数去掉括号后可查看函数对应的代码。带星号的不可以用这种方法。但是可以用<code>getAnywhere</code>查看代码</p>
<p>&nbsp;</p>
<p>定义泛型函数</p>
<p><img src="https://i.loli.net/2018/12/08/5c0bbb517fa87.jpg" alt="定义一个泛型函数"></p>
<p>当对象z被分配到两类时➍，第一类用来决定哪个泛型函数被调用。在最后一个例子中➎，没有<code>mymethod.c()</code>函数，因此下一个类（ a）被使用。 R从左到右搜索类的列表，寻找第一个可用的泛型函数。 </p>
<p>S3的局限性：任意的类能被分配到任意的对象上。没有完整性检验 </p>
<p>s4更加正式，更加严格。S4的对象和方法构造在强制执行的规则内被正式定义。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">FlorenceXie</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">102</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">FlorenceXie</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
